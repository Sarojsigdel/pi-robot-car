# PI-ROBOT-CAT

Note: Some of the node modules use for GPIO are not longer supported. Therefore the latest version of nodejs they can be built with is v8.17.0

## MJPEG Streamar

Setup Guide: Raspberry Pi | MJPEG Streamer Install & Setup & FFMpeg Recording <https://github.com/cncjs/cncjs/wiki/Setup-Guide:-Raspberry-Pi-%7C-MJPEG-Streamer-Install-&-Setup-&-FFMpeg-Recording>

## Start Server

    sudo node index.js | ./node_modules/.bin/bunyan

### NGINX installation

#### If needed remove apache if installed to avoid port conflicts

    sudo apt-get remove apache2

#### Install nginx

    sudo apt-get install nginx

##### Start nginx

    sudo systemctl start nginx

##### Try it

Open a browser and enter:
    http://[raspberry pi address]

### Get an SSL certificate from LetsEncrypt

The instructions below are from certbot.eff.org <https://certbot.eff.org/lets-encrypt/debianbuster-nginx>

#### Install certbot

    sudo apt-get install certbot python-certbot-nginx

#### Get a domain name (DuckDNS <https://www.duckdns.org/>)

#### Forward ports 80 and 443 to your raspberry pi address

#### Create a softlink from /etc/nginx/[your domain] to your actual web server

    sudo ln -s /home/pi/git/pi-robot-car/ .

#### Grab certificate

    sudo certbot certonly --nginx -w /var/www/example -d example.com -d www.example.com

Note: replace example.com by your domain

#### Change the nginx configuration to add your server name and certicates

Edit /etc/nginx/sites-enabled/default

    server {
            listen 80 default_server;
            listen [::]:80 default_server;

            # SSL configuration
            #
            listen 443 ssl default_server;
            listen [::]:443 ssl default_server;

            # Self signed certs generated by the ssl-cert package
            # Don't use them in a production server!
            ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
            ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

            root /var/www/example.com;

            # Add index.php to the list if you are using PHP
            index index.html index.htm index.nginx-debian.html;

            server_name example.com;

            location / {
                    # First attempt to serve request as file, then
                    # as directory, then fall back to displaying a 404.
                    try_files $uri $uri/ =404;
            }
    }

#### Try it using secure connection

    https://example.com

#### Every 3 months the ceritificate needs to be renewed

To obtain a new or tweaked version of this certificate in the future, simply run certbot again with the "certonly" option. To non-interactively renew *all* of your certificates, run "certbot renew"
